<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pomodoro Timer</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f0f0f0;
        margin: 0;
      }

      .tomato {
        position: relative;
        width: 250px;
        height: 250px;
        background: radial-gradient(circle, #ff4d4d 30%, #d63333 100%);
        border-radius: 50%;
        box-shadow: inset -10px -10px 20px rgba(0, 0, 0, 0.3),
          0 10px 30px rgba(0, 0, 0, 0.3);
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
      }

      .stem {
        position: absolute;
        top: -15px;
        left: 50%;
        width: 60px;
        height: 60px;
        background-color: #2a7a2a;
        border-radius: 50%;
        transform: translateX(-50%);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .numbers {
        position: absolute;
        left: 60%;
        transform: translateX(-50%);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        color: white;
        transition: transform 0.3s ease-in-out;
      }

      .numbers span {
        margin: 0 5px;
        opacity: 0.5;
        transition: opacity 0.3s;
      }

      .highlight {
        opacity: 1;
        font-size: 30px;
      }

      .arrow {
        position: absolute;
        width: 0;
        height: 0;
        border-left: 10px solid transparent;
        border-right: 10px solid transparent;
        border-bottom: 20px solid black;
        top: 140px;
        left: 50%;
        transform: translateX(-50%);
        visibility: visible;
      }

      .controls {
        margin-top: 20px;
      }

      button {
        margin: 0 10px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #28a745; /* Green */
        color: white;
        border: none;
        border-radius: 5px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        transition: background-color 0.3s, transform 0.2s;
      }

      button:hover {
        background-color: #218838; /* Darker green on hover */
        transform: scale(1.05); /* Slightly grow the button */
      }

      button:active {
        transform: scale(0.95); /* Slightly shrink on click */
      }
    </style>
  </head>
  <body>
    <h1>POMODORO TIMER</h1>
    <div class="tomato">
      <div class="stem"></div>
      <div class="arrow" id="arrow"></div>
      <div class="numbers" id="numbers"></div>
    </div>

    <div class="controls">
      <button id="startButton">Start</button>
      <button id="stopButton" style="display: none">Stop</button>
    </div>

    <audio
      id="beepSound"
      src="E:\Personal Project\pomodoro\point-smooth-beep-230573.mp3"
      preload="auto"
    ></audio>

    <script>
      let workDuration = 25 * 60; // 25 minutes in seconds
      let breakDuration = 5 * 60; // 5 minutes in seconds
      let currentNumber = workDuration / 60; // Start at 25 minutes
      let timerInterval;

      function highlightNumber(minutes) {
        document.querySelectorAll(".numbers span").forEach((num) => {
          num.classList.remove("highlight");
          num.style.opacity = "0.5"; // Dim inactive numbers
        });

        const currentMinuteElement = document.getElementById(`num${minutes}`);
        currentMinuteElement.classList.add("highlight");
        currentMinuteElement.style.opacity = "1"; // Highlight the active minute
      }

      function moveArrow(percentage) {
        const numbersContainer = document.getElementById("numbers");
        const totalNumbers = 25; // Numbers 0 to 25
        const moveAmount = 100 / totalNumbers; // Percentage to move for each number
        const offset = percentage * moveAmount; // Calculate the offset

        // Move the numbers container to show the current number
        numbersContainer.style.transform = `translateX(-${offset}%)`;
      }

      function startTimer() {
        highlightNumber(currentNumber); // Highlight the starting number
        moveArrow(currentNumber); // Move arrow to the starting position
        let secondsPassed = 0;

        timerInterval = setInterval(() => {
          secondsPassed += 1;

          // Change number only after a full minute has passed
          if (secondsPassed % 60 === 0) {
            currentNumber -= 1; // Decrement the minute
            highlightNumber(currentNumber); // Highlight the current minute
            moveArrow(currentNumber); // Move arrow to the current position

            // Check if the work timer has completed
            if (currentNumber < 0) {
              clearInterval(timerInterval);
              document.getElementById("beepSound").play(); // Play beep sound
              alert("Pomodoro session completed! Starting break...");
              startBreak(); // Start break timer after work session
            }
          }
        }, 1000); // Check every second for minute completion

        document.getElementById("startButton").style.display = "none"; // Hide Start button
        document.getElementById("stopButton").style.display = "inline"; // Show Stop button
      }

      function startBreak() {
        currentNumber = breakDuration / 60; // Set to break duration
        highlightNumber(currentNumber); // Highlight starting number for break
        moveArrow(currentNumber); // Move arrow to the starting position
        let secondsPassed = 0;

        timerInterval = setInterval(() => {
          secondsPassed += 1;

          // Change number only after a full minute has passed
          if (secondsPassed % 60 === 0) {
            currentNumber -= 1; // Decrement the minute
            highlightNumber(currentNumber); // Highlight the current minute
            moveArrow(currentNumber); // Move arrow to the current position

            // Check if the break timer has completed
            if (currentNumber < 0) {
              clearInterval(timerInterval);
              document.getElementById("beepSound").play(); // Play beep sound
              alert("Break time is over! Starting a new Pomodoro session...");
              resetTimer(); // Reset timer after completion
            }
          }
        }, 1000); // Check every second for minute completion
      }

      function stopTimer() {
        clearInterval(timerInterval);
        resetTimer(); // Reset the timer
      }

      function resetTimer() {
        currentNumber = workDuration / 60; // Reset to 25 minutes
        highlightNumber(currentNumber); // Highlight starting number
        moveArrow(currentNumber); // Move arrow to the starting position
        document.getElementById("startButton").style.display = "inline"; // Show Start button
        document.getElementById("stopButton").style.display = "none"; // Hide Stop button
      }

      // Populate numbers 0 to 25
      const numbersContainer = document.getElementById("numbers");
      for (let i = 0; i <= 25; i++) {
        const span = document.createElement("span");
        span.id = `num${i}`;
        span.innerText = i;
        numbersContainer.appendChild(span);
      }

      highlightNumber(currentNumber); // Highlight starting number (25)
      document
        .getElementById("startButton")
        .addEventListener("click", startTimer);
      document
        .getElementById("stopButton")
        .addEventListener("click", stopTimer);
    </script>
  </body>
</html>
